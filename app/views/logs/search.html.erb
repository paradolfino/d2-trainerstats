<br/>
<h5 class="text-center">Showing <%= pluralize(@trainings.count, "trainings") %></h5>
<table class="table text-center">
    <thead>
        <tr>
            <th>Date/Time Logged</th>
            <th>Member Name</th>
            <th>Company Name</th>
            <th><%= select_tag "filter", options_from_collection_for_select(@users, :name, :name), :onchange => "filter()", prompt: "Trainer" %></th>
            <th><%= select_tag "sort", options_for_select(["1st Launch", "2nd Launch", "Follow Up", "One-on-One", "Demonstration"]), :onchange => "sort()", prompt: "Stage", data: {url: @url} %></th>
            <th>Status</th>
            <th>Options</th>
        </tr>
    </thead>
    <tbody>
        <% if params[:query] %>
            <% @trainings.sort.reverse_each do |t| %>
                <tr>
                    <td><%= t[1][:info]["created_at"] %></td>
                    <td><%= trunk(t[1][:info]["member"]) %></td>
                    <td><%= trunk(t[1][:info]["company"]) %></td>
                    <td><%= t[1][:info]["trainer"] %></td> 
                    <td><%= t[1][:info]["stage"] %></td> 
                    <td><%= t[1][:info]["status"] %></td> 
                    <td><%= link_to fa_icon("search", text: "View"), "/logs/#{t[1][:info]["id"]}/trainings/#{t[1][:info]["log_id"]}" %><% if is_admin? %> | <%= link_to fa_icon("trash", text: "Delete"), "/logs/#{t[1][:info]["id"]}/trainings/#{t[1][:info]["log_id"]}", method: :delete  %><% end %></td>
                </tr>
            <% end %>
        <% end %>
    </tbody>
</table>

<script>
    function filter() {
        var val = $("#filter").find(":selected").text();
        window.location.replace("/search?query=trainer&string=" + val.toLowerCase());
    }
    
    function sort(type) {
        var query = $("#sort").find(":selected").text();
        alert(<%= @url %>);
    }
</script>